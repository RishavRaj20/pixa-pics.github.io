(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{541:function(t,e,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(){function t(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function e(t){return t>W?Math.pow(t,1/3):t/V+K}function n(t,e){return(0|d(t=(0|t)>>>0,e=(0|e)>>>0))>>>0}function i(t){return((t=(0|t)>>>0)<<2|0)>>>0}function o(t){return((t=(0|t)>>>0)>>2|0)>>>0}function s(t){return((t=(0|t)>>>0)>>5|0)>>>0}function _(t){return((t=(0|t)>>>0)>>6|0)>>>0}function l(t){return((t=(0|t)>>>0)/85|0)>>>0}function u(t){return((t=(0|t)>>>0)>>7|0)>>>0}function c(t,e,n){return n|=0,0|((t|=0)<(e|=0)?e:t>n?n:t)}function p(t){return 255&(0|(0|t)>>>0)}function h(t){return(0|(t|=0))<0?0|-t:0|t}function a(t){t=(0|t)>>>0,this.l_=0|t,this.a_=new Uint32Array((this.l_+31|0)>>>5),this.M_OR_=Uint32Array.of(1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648),this.M_AND_=Uint32Array.of(4294967294,4294967293,4294967291,4294967287,4294967279,4294967263,4294967231,4294967167,4294967039,4294966783,4294966271,4294965247,4294963199,4294959103,4294950911,4294934527,4294901759,4294836223,4294705151,4294443007,4293918719,4292870143,4290772991,4286578687,4278190079,4261412863,4227858431,4160749567,4026531839,3758096383,3221225471,2147483647)}var f,g,y,d=Math.imul||function(t,e){var n=65535&t,r=65535&e;return n*r+((t>>>16&65535)*r+n*(e>>>16&65535)<<16>>>0)|0},b=Math.round,x=Math.ceil,w=Math.fround,m=function(t){return 0|d(0|(t|=0),0|t)},O=function(t){var e,n;if(0==(0|(t=(0|t)>>>0))||1==(0|t))return 0|t;for(e=1,n=1;(0|n)<=(0|t);)n=((e=(e+1|0)>>>0)*e|0)>>>0;return(e-1|0)>>>0},j=w(.8967),P=w(1.761),v=w(.342),k=Float32Array.of(j,P,v),A=w(1.185),U=w(.107),M=w(.112),B=Float32Array.of(A,U,M),S=255,z=255,F=255,D=Uint8Array.of(S,z,F,255),R=(0|O(j*S*S+P*z*z+v*F*F|0))>>>0,J=(j*S+P*z+v*F|0)>>>0,L=O(42768)>>>0,Q=w(.03),C=w(1),G=w(.333),I=w(.555),N=new Uint8Array(4),q=new Float32Array(2),E=w(.96422),H=w(.82521),K=w(4/29),T=w(6/29),V=3*T*T,W=T*T*T,X=function Y(t,e){if(!(this instanceof Y))return new Y(t,e);var n,r;e|=0,this.storage_uint8_=new Uint8Array(t,i(e),function(t,e){return 0|((0|(t|=0))>(0|(e|=0))?t:0)}(function(t,e){return 0|((0|(t|=0))>(0|(e|=0))?e:4)}(4,(n=t.byteLength,r=i(e),(n|=0)-(r|=0)|0)),0))};return Object.defineProperty(X.prototype,"r",{get:function(){return p(this.storage_uint8_[3])}}),Object.defineProperty(X.prototype,"g",{get:function(){return p(this.storage_uint8_[2])}}),Object.defineProperty(X.prototype,"b",{get:function(){return p(this.storage_uint8_[1])}}),Object.defineProperty(X.prototype,"a",{get:function(){return p(this.storage_uint8_[0])}}),Object.defineProperty(X.prototype,"uint32",{get:function(){return(this.storage_uint8_[3]<<24|this.storage_uint8_[2]<<16|this.storage_uint8_[1]<<8|this.storage_uint8_[0])>>>0}}),Object.defineProperty(X.prototype,"laba",{get:function(){var n,r,i=t(this.r),o=t(this.g),s=t(this.b),_=e((.2225045*i+.7168786*o+.0606169*s)/1);return i===o&&o===s?n=r=_:(n=e((.4360747*i+.3850649*o+.1430804*s)/E),r=e((.0139322*i+.0971045*o+.7141733*s)/H)),Float32Array.of(116*_-16,500*(n-_),200*(_-r),this.a)},enumerable:!1,configurable:!1}),Object.defineProperty(X.prototype,"rgbaon4bits",{get:function(){return(u(this.storage_uint8_[3])<<3|u(this.storage_uint8_[2])<<2|u(this.storage_uint8_[1])<<1|u(this.storage_uint8_[0])<<0|0)>>>0}}),Object.defineProperty(X.prototype,"rgbaon6bits",{get:function(){return((16^l(this.storage_uint8_[3]))+(8^l(this.storage_uint8_[2]))+(4^l(this.storage_uint8_[1]))+(0^l(this.storage_uint8_[0]))|0)>>>0}}),Object.defineProperty(X.prototype,"rgbaon8bits",{get:function(){return(_(this.storage_uint8_[3])<<6|_(this.storage_uint8_[2])<<4|_(this.storage_uint8_[1])<<2|_(this.storage_uint8_[0])<<0|0)>>>0}}),Object.defineProperty(X.prototype,"rgbaon12bits",{get:function(){return(s(this.storage_uint8_[3])<<9|s(this.storage_uint8_[2])<<6|s(this.storage_uint8_[1])<<3|s(this.storage_uint8_[0])<<0|0)>>>0}}),Object.defineProperty(X.prototype,"offset",{get:function(){return o(this.storage_uint8_.byteOffset)}}),Object.defineProperty(X.prototype,"buffer",{get:function(){return this.storage_uint8_.buffer.slice(this.storage_uint8_.byteOffset,(4+((0|this.storage_uint8_.byteOffset)>>>0)|0)>>>0)}}),Object.defineProperty(X.prototype,"subarray",{get:function(){return this.storage_uint8_.subarray(0,4)}}),Object.defineProperty(X.prototype,"skin",{get:function(){var t,e=(this.b+this.g+this.r|0)>>>0;return(0|e)>0&&(N[0]=c((3*this.r|0)/e|0,0,255),N[1]=c((3*this.g|0)/e|0,0,255),N[2]=c((3*this.b|0)/e|0,0,255),t=(0|m((N[0]+N[1]+N[2]|0)>>>0))>>>0,w(N[0]/N[1])>B[0]&&w(((N[0]*N[2]|0)>>>0)/t)>B[1]&&w(((N[0]*N[1]|0)>>>0)/t)>B[2])}}),Object.defineProperty(X.prototype,"set_from_array",{get:function(){return function(t){this.storage_uint8_[0]=p(t[0]),this.storage_uint8_[1]=p(t[1]),this.storage_uint8_[2]=p(t[2]),this.storage_uint8_[3]=p(t[3])}}}),Object.defineProperty(X.prototype,"slice",{get:function(){return function(t,e){return this.storage_uint8_.slice(t,e)}}}),Object.defineProperty(X.prototype,"simplify",{get:function(){return function(t){t=w(t),this.storage_uint8_[0]=c(n(x(this.a/t),t),0,255),this.storage_uint8_[1]=c(n(b(this.b/t),t),0,255),this.storage_uint8_[2]=c(n(b(this.g/t),t),0,255),this.storage_uint8_[3]=c(n(b(this.r/t),t),0,255)}}}),X.blend_all=function(t,e,n){for(var r,i=0|t.r,o=0|t.g,s=0|t.b,_=0|t.a,l=w(1),u=w(0),p=0|e.length,h=0;(0|h)<(0|p);h=h+1|0)r=e[0|h],u=w(n[0|h]),l=w(l+u),_=w(_+r.a*u),s=w(s+r.b*u),o=w(o+r.g*u),i=w(i+r.r*u);for(N[0]=c(b(_/l),0,255),N[1]=c(b(s/l),0,255),N[2]=c(b(o/l),0,255),N[3]=c(b(i/l),0,255),t.set_from_array(N),h=0;(0|h)<(0|p);h=h+1|0)e[0|h].set_from_array(N)},X.prototype.euclidean_match_with=function(t,e){return e=w(e),q[0]=w(C-w(h(this.a-t.a|0)/D[3])),q[1]=w(q[0]*q[0]-Q),w(O(k[0]*m(this.r-t.r|0)+k[1]*m(this.g-t.g|0)+k[2]*m(this.b-t.b|0)|0)/R)<w(e*q[1])},X.prototype.manhattan_match_with=function(t,e){return e=w(e),q[0]=w(C-w(h(this.a-t.a|0)/D[3])),q[1]=w(q[0]*q[0]-Q),w(w(k[0]*h(this.r-t.r|0)+k[1]*h(this.g-t.g|0)+k[2]*h(this.b-t.b|0)|0)/J)<w(e*q[1])},X.prototype.cie76_match_with=function(t,e){e=w(e),q[0]=w(C-w(h(this.a-t.a|0)/D[3])),q[1]=w(q[0]*q[0]-Q);var n=this.laba,r=t.laba;return w(O(m(n[0]-r[0])+m(n[1]-r[1])+m(n[2]-r[2])|0)/L)<w(e*q[1])},X.prototype.copy=function(t){return X(this.slice(0,4))},Object.defineProperty((f=function Z(t,e,n){if(!(this instanceof Z))return new Z(t);this.storage_="buffer"in t?t.buffer:t,e|=0,n=0|n||0|this.storage_.byteLength,this.storage_uint32_array_=new Uint32Array(this.storage_,e,o(n))}).prototype,"length",{get:function(){return this.storage_uint32_array_.length}}),Object.defineProperty(f.prototype,"buffer",{get:function(){return this.storage_}}),Object.defineProperty(f.prototype,"buffer_getUint32",{get:function(){return function(t){return this.storage_uint32_array_[0|t]}}}),Object.defineProperty(f.prototype,"slice_uint32",{get:function(){return function(t,e){return t|=0,e=(e|=0)||this.length,this.storage_uint32_array_.slice(t,e)}}}),Object.defineProperty(f.prototype,"subarray_uint32",{get:function(){return function(t,e){return t|=0,e=(e|=0)||this.length,this.storage_uint32_array_.subarray(t,e)}}}),f.prototype.get_element=function(t){return X(this.buffer,0|t)},Object.defineProperty(a.prototype,"readBit",{get:function(){return function(t){t=(0|t)>>>0;var e=this.M_OR_[31&t];return t=(0|t)>>>5,(this.a_[0|t]&e|0)==(0|e)}},enumerable:!1,configurable:!1}),Object.defineProperty(a.prototype,"writeBit1",{get:function(){return function(t){t=(0|t)>>>0;var e=this.M_OR_[31&t];t=(0|t)>>>5,this.a_[0|t]=this.a_[0|t]|e}},enumerable:!1,configurable:!1}),Object.defineProperty(a.prototype,"length",{get:function(){return(0|this.l_)>>>0},enumerable:!1,configurable:!1}),Object.defineProperty((g=function $(t){var e,n;if(!(this instanceof $))return new $(t);if("object"==(void 0===t?"undefined":r(t))){for(this.set_=new Set(Array.from(t)),this.s_=this.set_.size,this.indexes_=Array.from(this.set_),this.max_=0,e=0,n=0|this.indexes_.length;(0|e)<(0|n);e=e+1|0)(0|this.max_)<(0|this.indexes_[0|e])&&(this.max_=0|this.indexes_[0|e]);for(this.a_=new a(this.max_),e=0,n=0|this.indexes_.length;(0|e)<(0|n);e=e+1|0)this.a_.writeBit1(0|this.indexes_[0|e]);delete this.set_,delete this.indexes_,delete this.max_}else this.a_=new a(t),this.s_=0}).prototype,"size",{get:function(){return(0|this.s_)>>>0},enumerable:!1,configurable:!1}),Object.defineProperty(g.prototype,"length",{get:function(){return(0|this.a_.length)>>>0},enumerable:!1,configurable:!1}),Object.defineProperty(g.prototype,"indexes",{get:function(){for(var t=[],e=0|this.length,n=0;(0|n)<(0|e);n=(n+32|0)>>>0)t.push.apply(t,this.a_.readFourBytes(0|n));return t},enumerable:!1,configurable:!1}),Object.defineProperty(g.prototype,"has",{get:function(){return function(t){return t=(0|t)>>>0,this.a_.readBit(0|t)}},enumerable:!1,configurable:!1}),Object.defineProperty(g.prototype,"add",{get:function(){return function(t){if(t=(0|t)>>>0,(0|this.length)<(0|t)){var e=this.indexes,n=0|e.length,r=0;for(this.a_=new a(t+t|0);(0|r)<(0|n);r=r+1|0)this.a_.writeBit1(0|e[0|r]);this.s_=(0|e.length)>>>0}this.a_.readBit(0|t)||(this.s_=(this.s_+1|0)>>>0),this.a_.writeBit1(0|t)}},enumerable:!1,configurable:!1}),Object.defineProperty((y=function tt(t){if(t=t||{},!(this instanceof tt))return new tt(t);t.pxl_colors=t.pxl_colors||new Uint32Array(0),t.pxls=t.pxls||new Uint32Array(0),this.new_pxls_="buffer"in t.pxls?new Uint32Array(t.pxls.buffer):Uint32Array.from(t.pxls),this.new_pxl_colors_="buffer"in t.pxl_colors?f(t.pxl_colors.buffer):f(Uint32Array.from(t.pxl_colors));var e=0|this.new_pxl_colors_.length;this.new_pxl_colors_is_skin_mask_=new g(0|e),this.set_new_pxl_skin_mask(),this.best_color_number_=t.number_of_color,this.max_cluster_=e>65536?65537:e>16384?4097:e>8192?257:e>512?17:1,this.index_clusters_=Array(this.max_cluster_),this.length_clusters_=new Uint32Array(this.max_cluster_),this.pxl_colors_usage_=new Uint32Array(e),this.all_index_clusters_=new Uint32Array(e),this.clean_pxl_colors_=new Uint32Array(e),this.clean_pxl_colors_lookup_={},this.is_skin_ops_=0,this.match_ops_=0,this.blend_ops_=0,this.remove_duplicate_ops_=0,this.simplify_ops_=0,this.classify_on_x_bits_ops_=0}).prototype,"set_is_skin_ops",{get:function(){return function(t){this.is_skin_ops_=(0|t)>>>0}}}),Object.defineProperty(y.prototype,"set_match_ops",{get:function(){return function(t){this.match_ops_=(0|t)>>>0}}}),Object.defineProperty(y.prototype,"set_blend_ops",{get:function(){return function(t){this.blend_ops_=(0|t)>>>0}}}),Object.defineProperty(y.prototype,"set_remove_duplicate_ops",{get:function(){return function(t){this.remove_duplicate_ops_=(0|t)>>>0}}}),Object.defineProperty(y.prototype,"set_simplify_ops",{get:function(){return function(t){this.simplify_ops_=t}}}),Object.defineProperty(y.prototype,"set_classify_on_x_bits_ops",{get:function(){return function(t){this.classify_on_x_bits_ops_=t}}}),Object.defineProperty(y.prototype,"get_is_skin_ops",{get:function(){return function(){return 0|this.is_skin_ops_}}}),Object.defineProperty(y.prototype,"get_match_ops",{get:function(){return function(){return 0|this.match_ops_}}}),Object.defineProperty(y.prototype,"get_blend_ops",{get:function(){return function(){return 0|this.blend_ops_}}}),Object.defineProperty(y.prototype,"get_remove_duplicate_ops",{get:function(){return function(){return 0|this.remove_duplicate_ops_}}}),Object.defineProperty(y.prototype,"get_simplify_ops",{get:function(){return function(){return this.simplify_ops_}}}),Object.defineProperty(y.prototype,"get_classify_on_x_bits_ops",{get:function(){return function(){return this.classify_on_x_bits_ops_}}}),Object.defineProperty(y.prototype,"reset_deduplicate",{get:function(){return function(t){this.clean_pxl_colors_lookup_={},this.pxl_colors_usage_.fill(0,0,0|t),this.clean_pxl_colors_.fill(0,0,0|t)}}}),Object.defineProperty(y.prototype,"index_of_color_within_cleaned",{get:function(){return function(t){return(0|this.clean_pxl_colors_lookup_[(0|t)>>>0])-1|0}}}),Object.defineProperty(y.prototype,"set_cleaned_pxl_colors",{get:function(){return function(t,e){this.clean_pxl_colors_[(0|t)>>>0]=(0|e)>>>0,this.clean_pxl_colors_lookup_[(0|e)>>>0]=(t+1|0)>>>0}}}),Object.defineProperty(y.prototype,"increase_color_usage",{get:function(){return function(t){this.pxl_colors_usage_[(0|t)>>>0]=(this.pxl_colors_usage_[(0|t)>>>0]+1|0)>>>0}}}),Object.defineProperty(y.prototype,"set_new_pxls",{get:function(){return function(t,e){this.new_pxls_[(0|t)>>>0]=(0|e)>>>0}}}),Object.defineProperty(y.prototype,"set_new_pxl_colors",{get:function(){return function(t){this.new_pxl_colors_=f(this.clean_pxl_colors_.buffer.slice(0,i(0|t))),this.set_new_pxl_skin_mask()}}}),Object.defineProperty(y.prototype,"set_new_pxl_skin_mask",{get:function(){return function(){var t=new X(new ArrayBuffer(4)),e=0|this.new_pxl_colors_.length,n=0;for(this.new_pxl_colors_is_skin_mask_=new g(0|e);(0|n)<(0|e);n=n+1|0)this.new_pxl_colors_.get_element(0|n,t).skin&&this.new_pxl_colors_is_skin_mask_.add(0|n);this.set_is_skin_ops(this.get_is_skin_ops()+n|0)}}}),Object.defineProperty(y.prototype,"get_a_new_pxl_color_from_pxl_index",{get:function(){return function(t){return 4294967295&this.new_pxl_colors_.buffer_getUint32(this.new_pxls_[0|t])}}}),Object.defineProperty(y.prototype,"reset_cluster",{get:function(){return function(){this.max_cluster_=this.new_pxl_colors_.length>65536?65537:this.new_pxl_colors_.length>16384?4097:this.new_pxl_colors_.length>8192?257:this.new_pxl_colors_.length>512?17:1,this.length_clusters_.fill(0,0,0|this.max_cluster);for(var t=0;(0|t)<(0|this.max_cluster);t=(t+1|0)>>>0)this.index_clusters_[0|t]=[]}}}),Object.defineProperty(y.prototype,"add_in_indexes_cluster",{get:function(){return function(t,e){this.index_clusters_[(0|t)>>>0].push((0|e)>>>0)}}}),Object.defineProperty(y.prototype,"set_all_cluster_indexes",{get:function(){return function(){for(var t=0,e=0;(0|t)<(0|this.max_cluster);t=(t+1|0)>>>0)this.all_index_clusters_.set(this.index_clusters_[(0|t)>>>0],(0|e)>>>0),e=(e+this.get_length_in_index_clusters(0|t)|0)>>>0}}}),Object.defineProperty(y.prototype,"get_length_in_index_clusters",{get:function(){return function(t){return(0|this.index_clusters_[(0|t)>>>0].length)>>>0}}}),Object.defineProperty(y.prototype,"get_in_cluster_lengths",{get:function(){return function(t){return(0|this.length_clusters_[(0|t)>>>0])>>>0}}}),Object.defineProperty(y.prototype,"get_an_index_in_clusters",{get:function(){return function(t){return(0|this.all_index_clusters_[0|t])>>>0}}}),Object.defineProperty(y.prototype,"get_a_color_usage",{get:function(){return function(t){return(0|this.pxl_colors_usage_[0|t])>>>0}}}),Object.defineProperty(y.prototype,"set_a_color_usage",{get:function(){return function(t,e){return this.pxl_colors_usage_[0|t]=(0|e)>>>0}}}),Object.defineProperty(y.prototype,"get_a_color_usage_percent",{get:function(){return function(t){return this.pxl_colors_usage_[0|t]/this.new_pxls_.length}}}),Object.defineProperty(y.prototype,"get_average_color_usage_percent",{get:function(){return function(t,e){var n,r,i;for(e=0|((e|=0)<(t|=0)?this.pxl_colors_usage_.length:e),n=0,r=0,i=0,r=0|t;(0|r)<(0|e);r=(r+1|0)>>>0)i=(0|this.get_an_index_in_clusters((0|r)>>>0))>>>0,n+=this.pxl_colors_usage_[0|i]/this.new_pxls_.length;return n/(e-t|0)}}}),Object.defineProperty(y.prototype,"get_a_new_pxl_color",{get:function(){return function(t){return this.new_pxl_colors_.get_element(0|t)}}}),Object.defineProperty(y.prototype,"is_pxl_color_skin",{get:function(){return function(t){return this.new_pxl_colors_is_skin_mask_.has(0|t)}}}),Object.defineProperty(y.prototype,"max_cluster",{get:function(){return 0|this.max_cluster_}}),Object.defineProperty(y.prototype,"new_pxls_length",{get:function(){return 0|this.new_pxls_.length}}),Object.defineProperty(y.prototype,"new_pxl_colors_length",{get:function(){return 0|this.new_pxl_colors_.length}}),Object.defineProperty(y.prototype,"best_color_number",{get:function(){return 0|this.best_color_number_}}),Object.defineProperty(y.prototype,"get_data",{get:function(){return function(){return Array.of(this.new_pxls_,this.new_pxl_colors_.subarray_uint32(0,this.new_pxl_colors_.length),{deduplicate:this.get_remove_duplicate_ops(),simplify:this.get_simplify_ops(),classify:this.get_classify_on_x_bits_ops(),skin:this.get_is_skin_ops(),blend:this.get_blend_ops(),match:this.get_match_ops()})}}}),y.prototype.output=function(t){var e,n;return t=t||"heap",e=this.get_data(),"heap"==t?((n=new Uint32Array(2+e[0].length+e[1].length))[0]=0|e[0].length,n[1]=0|e[1].length,n.set(e[0],2),n.set(e[1],2+e[0].length),n.buffer):e},y.prototype.deduplicate=function(){var t,e,n,r,i;for(this.set_remove_duplicate_ops(this.get_remove_duplicate_ops()+1|0),this.reset_deduplicate(0|this.new_pxl_colors_length),t=0,e=0,n=0,r=0,i=0|this.new_pxls_length;(0|r)<(0|i);r=(r+1|0)>>>0)e=0|this.get_a_new_pxl_color_from_pxl_index(0|r),-1==(0|(n=0|this.index_of_color_within_cleaned(0|e)))&&(this.set_cleaned_pxl_colors(0|t,0|e),n=0|t,t=t+1|0),this.increase_color_usage(0|n),this.set_new_pxls(0|r,0|n);this.set_new_pxl_colors(t)},y.prototype.clusterize=function(){this.reset_cluster();var t=0;if(65537===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon16bits)>>>0,(0|t)>>>0);else if(4097===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon12bits)>>>0,(0|t)>>>0);else if(257===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon8bits)>>>0,(0|t)>>>0);else if(17===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon4bits)>>>0,(0|t)>>>0);else if(1===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster(0,(0|t)>>>0);this.max_cluster>1&&this.set_classify_on_x_bits_ops(this.get_classify_on_x_bits_ops()+this.new_pxl_colors_length),this.set_all_cluster_indexes()},y.prototype.process_threshold=function(t){var e,n,r,i,o,s,_,l,u,c,p,h,a,f,g,y,d,b,x,m,O;for(e=!1,n=[],r=[],i=0,o=0,l=!1,u=!1,c=0,p=0,h=w((t=(0|t)>>>0)/255),g=0,y=0,d=0,b=0,x=0,m=0,O=0,f=w(h*I),a=w(h*G);(0|x)<(0|this.max_cluster);x=(x+1|0)>>>0){for(o=(i+((0|this.get_length_in_index_clusters(0|x))>>>0)|0)>>>0,d=0|i;(0|d)<(0|o);d=(d+1|0)>>>0){if(g=(0|this.get_an_index_in_clusters((0|d)>>>0))>>>0,s=this.get_a_new_pxl_color((0|g)>>>0),l=this.is_pxl_color_skin((0|g)>>>0),(0|(c=(0|this.get_a_color_usage((0|g)>>>0))>>>0))>0)for(n=[],b=0|i;(0|b)<(0|o);b=(b+1|0)>>>0)y=(0|this.get_an_index_in_clusters((0|b)>>>0))>>>0,_=this.get_a_new_pxl_color((0|y)>>>0),u=this.is_pxl_color_skin((0|y)>>>0),(0|(p=(0|this.get_a_color_usage((0|y)>>>0))>>>0))>0&&(0|g)!=(0|y)&&(O=(O+1|0)>>>0,s.euclidean_match_with(_,l&&u?f:l||u?a:h)&&(e=!0,this.set_a_color_usage(0|y,0),n.push(_),r.push(w(p/c))));(0|n.length)>0&&(X.blend_all(s,n,r),m=(m+n.length+1|0)>>>0,n=[],r=[])}i=0|o}return this.set_match_ops(this.get_match_ops()+O),this.set_blend_ops(this.get_blend_ops()+m),e},y.prototype.round=function(){var t,e;if(this.new_pxl_colors_length>8192){for(t=0|(this.new_pxl_colors_length>32768?12:this.new_pxl_colors_length>16384?10:this.new_pxl_colors_length>8192?8:this.new_pxl_colors_length>2048?6:this.new_pxl_colors_length>512?4:2),e=0;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.get_a_new_pxl_color((0|e)>>>0).simplify(t);this.set_simplify_ops(this.get_simplify_ops()+this.new_pxl_colors_length)}},y.prototype.init=function(){return this.round(),this.deduplicate(),this.clusterize(),this},y.prototype.run=function(){for(var t=2*(this.new_pxl_colors_length>32768?6:this.new_pxl_colors_length>16384?5:this.new_pxl_colors_length>8192?4:this.new_pxl_colors_length>4096?3:this.new_pxl_colors_length>2048?2:1)|0;(0|t)<=255&&(this.process_threshold(0|t)?(this.deduplicate(),this.clusterize()):t=t+(this.new_pxl_colors_length>32768?6:this.new_pxl_colors_length>16384?5:this.new_pxl_colors_length>8192?4:this.new_pxl_colors_length>4096?3:this.new_pxl_colors_length>2048?2:1)|0,t=t+(this.new_pxl_colors_length>32768?6:this.new_pxl_colors_length>16384?5:this.new_pxl_colors_length>8192?4:this.new_pxl_colors_length>4096?3:this.new_pxl_colors_length>2048?2:1)|0,!(this.new_pxl_colors_length<=this.best_color_number)););return this},y}();t.exports={QuantiMatGlobal:function(t,e){return new Promise((function(n){var r,o,s,_,l,u,c,p,h,a=new Uint32Array(t.data.subarray(0,t.data.length).reverse().buffer).reverse(),f=Uint32Array.from(new Set(a)),g=f.length,y=new Uint32Array(a.length);for(r=0,o=0|a.length;(0|r)<(0|o);r=(r+1|0)>>>0)y[0|r]=(0|f.indexOf((0|a[0|r])>>>0))>>>0;for(s=Date.now(),_=i({pxls:y,pxl_colors:f,number_of_color:e,width:t.width,height:t.height}).init().run().output("split"),l=Date.now(),c=0|(u=_[0]).length,p=u.length-1|0,h=_[1],r=0;(0|r)<(0|c);r=(r+1|0)>>>0)a[p-r|0]=(0|h[(0|u[0|r])>>>0])>>>0;n([t=new ImageData(new Uint8ClampedArray(a.buffer).reverse(),t.width,t.height),g-h.length,h.length,l-s|0])}))},QuantiMat:i}}}]);